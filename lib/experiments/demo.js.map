{
  "version": 3,
  "file": "demo.js",
  "sourceRoot": "../..",
  "sources": [
    "src/experiments/demo.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n\n'use strict'\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'PSPG/EXPERIMENTS/DEMO'\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\ninfo                      = CND.get_logger 'info',      badge\nurge                      = CND.get_logger 'urge',      badge\nhelp                      = CND.get_logger 'help',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\n# FS                        = require 'fs'\nPATH                      = require 'path'\nPS                        = require 'pipestreams'\n{ $\n  $async\n  select }                = PS\ntypes                     = require '../types'\n{ isa\n  validate\n  declare\n  size_of\n  type_of }               = types\n#...........................................................................................................\nrequire                   '../exception-handler'\n#...........................................................................................................\njoin_paths                = ( P... ) -> PATH.resolve PATH.join P...\nabspath                   = ( P... ) -> join_paths __dirname, P...\n{ to_width, width_of, }   = require 'to-width'\npull_stream_to_stream     = require 'pull-stream-to-stream'\nnew_pager                 = require 'default-pager'\npath_to_pspg              = abspath '../../pspg'\n\n'/usr/share/dict/words'\npath_1 = abspath '../../src/experiments/test-data-1.tsv'\n\n\n#-----------------------------------------------------------------------------------------------------------\n@walk_table_rows = ( rows, keys, widths ) ->\n  yield ' ' + (  ( ( to_width key, widths[ key ] ) for key in keys ).join ' | ' ) + ' '\n  yield '-' + (  ( ( to_width '', widths[ key ], { padder: '-', } ) for key in keys ).join '-+-' ) + '-'\n  for row in rows\n    yield ' ' + (  ( ( to_width row[ key ], widths[ key ] ) for key in keys ).join ' | ' ) + ' '\n  yield \"(#{rows.length} rows)\"\n  yield '\\n\\n'\n  return null\n\n\n#-----------------------------------------------------------------------------------------------------------\n@$collect_etc = ->\n  last      = Symbol 'last'\n  collector = []\n  widths    = {}\n  keys      = null\n  #.........................................................................................................\n  return PS.$ { last, }, ( row, send ) =>\n    if row is last\n      # console.table collector\n      send line for line from @walk_table_rows collector, keys, widths\n    else\n      keys ?= ( key for key of row )\n      d     = {}\n      for key of row\n        d[ key ]      = value = row[ key ].toString()\n        width         = width_of value\n        widths[ key ] = Math.max ( widths[ key ] ? 0 ), width\n      collector.push d\n    return null\n\n#-----------------------------------------------------------------------------------------------------------\n@$tee_as_table = =>\n  #.........................................................................................................\n  pipeline = []\n  pipeline.push @$collect_etc()\n  pipeline.push @$page_output()\n  pipeline.push PS.$drain()\n  #.........................................................................................................\n  return PS.$tee PS.pull pipeline...\n\n#-----------------------------------------------------------------------------------------------------------\n@$page_output = ( settings = null ) ->\n  defaults    =\n    pager:  path_to_pspg\n    args:   [  '-s17', '--force-uniborder', ]\n  #.........................................................................................................\n  settings    = if settings? then assign {}, defaults, settings else defaults\n  source      = PS.new_push_source()\n  stream      = pull_stream_to_stream.source PS.pull source\n  stream.pipe new_pager settings, -> urge 'ok'\n  last        = Symbol 'last'\n  #.........................................................................................................\n  return PS.$watch { last, }, ( line ) ->\n    return source.end() if line is last\n    line  = line.toString() unless isa.text line\n    line += '\\n'            unless isa.line line\n    source.send line\n    return null\n\n#-----------------------------------------------------------------------------------------------------------\n@demo = ->\n  source    = PS.read_from_file path_1\n  pipeline  = []\n  pipeline.push source\n  pipeline.push PS.$split_tsv()\n  pipeline.push PS.$name_fields 'fncr', 'glyph', 'formula'\n  pipeline.push @$add_random_words 10\n  pipeline.push @$add_ncrs()\n  pipeline.push @$add_numbers()\n  pipeline.push @$reorder_fields()\n  pipeline.push @$tee_as_table()\n  # pipeline.push @$page_output()\n  pipeline.push PS.$show()\n  pipeline.push PS.$drain()\n  PS.pull pipeline...\n\n#-----------------------------------------------------------------------------------------------------------\n@$reorder_fields = -> $ ( row, send ) =>\n  { nr\n    fncr\n    nr2\n    glyph\n    glyph_ncr\n    nr3\n    formula\n    formula_ncr\n    bs }        = row\n  send { nr, fncr, nr2, glyph, glyph_ncr, nr3, formula, formula_ncr, bs, }\n\n#-----------------------------------------------------------------------------------------------------------\n@$add_ncrs = ->\n  return $ ( row, send ) =>\n    row.glyph_ncr   = to_width ( @text_as_ncrs row.glyph    ), 20\n    row.formula_ncr = to_width ( @text_as_ncrs row.formula  ), 20\n    send row\n\n#-----------------------------------------------------------------------------------------------------------\n@$add_numbers = ->\n  nr = 0\n  return $ ( row, send ) =>\n    nr             += +1\n    row.nr          = nr\n    row.nr2         = nr ** 2\n    row.nr3         = nr ** 3\n    send row\n\n#-----------------------------------------------------------------------------------------------------------\n@text_as_ncrs = ( text ) ->\n  R = []\n  for chr in Array.from text\n    cid_hex = ( chr.codePointAt 0 ).toString 16\n    R.push \"&#x#{cid_hex};\"\n  return R.join ''\n\n#-----------------------------------------------------------------------------------------------------------\n@$add_random_words = ( n = 1 ) ->\n  validate.count n\n  CP    = require 'child_process'\n  count = Math.min 1e5, n * 1000\n  words = ( ( CP.execSync \"shuf -n #{count} /usr/share/dict/words\" ).toString 'utf-8' ).split '\\n'\n  words = ( word.replace /'s$/g, '' for word in words )\n  words = ( word for word in words when word isnt '' )\n  return $ ( fields, send ) =>\n    fields.bs = ( words[ CND.random_integer 0, count ] for _ in [ 0 .. n ] ).join ' '\n    send fields\n\n\n############################################################################################################\nunless module.parent?\n  do =>\n    @demo()\n\n\n"
  ]
}